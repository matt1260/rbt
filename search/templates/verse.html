{% extends 'base.html' %}
{% block title %}Real Bible Translation - {{ page_title }}{% endblock %}
{% load custom_tags %}
{% block content %}





<style>

    /* Style for the STRONGS pop-up container */
    .popup-container {
        position: relative; /* Create a positioning context */
        display: inline-block; /* Display the container inline */
    }
    /* Style for the pop-up content */
    .popup-content {
        display: none; /* Initially hide the content */
        position: absolute; /* Position it absolutely within the container */
        top: 100%; /* Position below the container */
        left: 0;
        background-color: #fff; /* Background color */
        border: 1px solid #e3e6ea; /* Border */
        padding: 10px; /* Padding */
        box-shadow: 0 6px 20px rgba(18, 38, 63, 0.08); /* Softer shadow */
        z-index: 200; /* Ensure it's above other content */
        width: 320px; /* Adjust the width as needed */
        font-size: 13px;
        text-align: left;
        border-radius: 8px;
        opacity: 0;
        transform: translateY(-6px);
        transition: opacity 0.12s ease, transform 0.12s ease;
    }

    /* Header label is now part of the content layout */

    /* Style to show the pop-up content on hover (fade/slide) */
    .popup-container:hover .popup-content {
        display: block; /* Show the content on hover */
        opacity: 1;
        transform: translateY(0);
    }

    /* Strong-specific popup enhancements */
    .strong-popup {
        padding: 8px 10px;
    }

    .strong-popup .strong-header {
        margin-bottom: 6px;
        border-bottom: 1px dashed #f1d7c7;
        padding-bottom: 6px;
    }

    .strong-popup .strong-lemma {
        font-size: 28px;
        font-weight: 700;
        color: #2a1f18;
    }

    .strong-popup .strong-xlit {
        font-size: 13px;
        color: #7b675a;
        font-style: italic;
        margin-top: 2px;
        letter-spacing: 0.04em;
        text-transform: none;
    }

    .strong-details {
        margin-top: 8px;
    }

    .strong-details dt {
        font-weight: 600;
        font-size: 11px;
        color: #6b4b3d;
        margin-top: 8px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .strong-details dd {
        margin: 2px 0 6px 0;
        font-size: 13px;
        color: #2f2f2f;
        line-height: 1.35;
    }

    .strong-popup .strong-fine-print {
        font-size: 11px;
        color: #6b4b3d;
        margin-top: 8px;
    }

    .strong-citation {
        margin-top: 10px;
        border-top: 1px dashed #f1d7c7;
        padding-top: 6px;
        font-size: 11px;
        color: #7b675a;
    }

    .strong-citation a {
        color: #a4491d;
        text-decoration: none;
        font-weight: 600;
    }

    .strong-citation a:hover {
        text-decoration: underline;
    }

    .strong-link {
        text-decoration: none;
        color: #a4491d;
        font-weight: 700;
        font-size: 12px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
    }


    .fuerst-popup {
        display: inline-flex;
        align-items: center;
        margin-left: 6px;
    }

    .fuerst-trigger {
        font-size: 10px;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-weight: 600;
        color: #7a2f11;
        background: linear-gradient(120deg, #fff7f2, #ffe9df);
        border: 1px solid #f1c7b2;
        border-radius: 999px;
        padding: 2px 7px;
        cursor: pointer;
        transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
    }

    .fuerst-trigger:hover,
    .fuerst-trigger:focus {
        background: linear-gradient(120deg, #ffe1d0, #ffd2bb);
        color: #5c210c;
        border-color: #e4a583;
    }

    .fuerst-popup-content {
        width: 360px;
        border-color: #f2d7c8;
    }

    .fuerst-title {
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #9a4a26;
        margin-bottom: 8px;
    }

    .fuerst-entry {
        padding: 8px 0;
        border-top: 1px dashed #f1d7c7;
    }

    .fuerst-entry:first-of-type {
        border-top: none;
        padding-top: 0;
    }

    .fuerst-headword {
        font-size: 20px;
        font-weight: 600;
        color: #1f2d3d;
    }

    .fuerst-meta {
        font-size: 11px;
        color: #6b4b3d;
        margin-top: 4px;
    }

    .fuerst-definition {
        font-size: 13px;
        color: #2f3a44;
        margin-top: 6px;
        line-height: 1.4;
    }

    .fuerst-note {
        font-size: 12px;
        color: #4b2b1f;
        background: #fff5ee;
        border-left: 3px solid #f3c2a7;
        padding: 4px 6px;
        margin-top: 6px;
    }

    .fuerst-link {
        color: #a4491d;
        text-decoration: none;
        font-weight: 600;
    }

    .fuerst-link:hover {
        text-decoration: underline;
    }




     /* Default styles for the desktop view */
     .desktop-view {
        display: block;
    }

    .mobile-view {
        display: none;
    }

    .front_search {
        border: none;
        display: table;
    }

    .front_search form {
        text-align: left;
        margin-bottom: 10px;
    }

    /* Styles for the mobile view */
    @media only screen and (max-width: 767px) {
        .desktop-view {
            display: none;
        }

        .mobile-view {
            display: block;
            margin-bottom: 10px;
        }
    }

    .verse-view {
        margin-top: 1px;
    }

    .strongs {
        font-size: 10px;
    }

    .eng_reader{
        font-size: 12px;
    }

    .hebrew_reader{
        font-size: 20px;
    }

    .hebrew-interlinear-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        justify-content: flex-start;  /* flex-start = right side in RTL */
        direction: rtl;
        margin-top: 16px;
        margin-bottom: 24px;
    }

    .interlinear-card {
        background: #f6f7fa;
        border: 1px solid #d9dee6;
        border-radius: 8px;
        padding: 12px 14px;
        min-width: 120px;
        max-width: 220px;
        text-align: right;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
    }

    .interlinear-card .card-hebrew {
        font-size: 28px;
        line-height: 1.3;
    }

    .card-hebrew > span {
        display: block;
    }

    .card-hebrew .hebrew-with-niqqud {
        display: none;
    }

    .interlinear-card .card-english {
        font-size: 14px;
        color: #2d2d2d;
        margin-top: 6px;
        direction: ltr;
    }

    .interlinear-card .card-strongs {
        font-size: 12px;
        color: #4a4a4a;
        margin-top: 6px;
        direction: ltr;
    }

    .interlinear-card .card-morph {
        font-size: 11px;
        color: #6d6d6d;
        margin-top: 6px;
        direction: ltr;
    }

    /* LXX (Septuagint) styles */
    .interlinear-card .card-lxx {
        font-size: 13px;
        color: #2e5984;
        margin-top: 6px;
        direction: ltr;
    }

    .interlinear-card .card-lxx a {
        color: #2e5984;
        text-decoration: none;
    }

    .interlinear-card .card-lxx a:hover {
        text-decoration: underline;
    }

    /* LXX popup tooltip container */
    .lxx-popup-container {
        position: relative;
        display: inline-block;
        cursor: help;
    }

    /* LXX popup content */
    .lxx-popup-content {
        display: none;
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background-color: #fff;
        border: 1px solid #ccc;
        padding: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        z-index: 100;
        width: 250px;
        font-size: 12px;
        text-align: left;
        border-radius: 4px;
        margin-bottom: 5px;
    }

    .lxx-popup-content .lxx-popup-header {
        font-size: 12px;
        font-weight: 600;
        margin-bottom: 2px;
        color: #333;
    }

    .lxx-popup-content .lxx-popup-header a {
        color: #2e5984;
        text-decoration: none;
        margin-left: 4px;
    }

    .lxx-popup-content .lxx-popup-header a:hover {
        text-decoration: underline;
    }

    .lxx-popup-content::after {
        content: "Greek translations of this Hebrew word in the Septuagint. This helps us understand how ancient translators interpreted the Hebrew text c. 250 BCE.";
        display: block;
        font-size: 10px;
        color: #888;
        margin-bottom: 6px;
        padding-bottom: 4px;
        border-bottom: 1px solid #eee;
    }

    .lxx-popup-container:hover .lxx-popup-content {
        display: block;
    }

    .lxx-stats-section {
        margin-top: 6px;
        padding-top: 4px;
        border-top: 1px dotted #ddd;
    }

    .lxx-stats-section .strongs-label {
        font-weight: 600;
        color: #555;
        font-size: 11px;
    }

    .lxx-stats-row {
        font-size: 11px;
        color: #444;
        line-height: 1.6;
        margin-bottom: 4px;
    }

    .lxx-stats-row .stat-label {
        display: inline-block;
        min-width: 80px;
        direction: ltr;
    }

    .lxx-stats-row .stat-label a {
        color: #2e5984;
        text-decoration: none;
    }

    .lxx-stats-row .stat-label a:hover {
        text-decoration: underline;
    }

    .lxx-stats-row .stat-bar-container {
        display: inline-block;
        width: 80px;
        height: 10px;
        background: #e9ecef;
        border-radius: 3px;
        margin: 0 6px;
        vertical-align: middle;
    }

    .lxx-stats-row .stat-bar {
        display: block;
        height: 100%;
        background: linear-gradient(90deg, #4a90a4, #2e5984);
        border-radius: 3px;
        min-width: 2px;
    }

    .lxx-stats-row .stat-info {
        font-size: 10px;
        color: #666;
    }

    .interlinear-legacy {
        margin-top: 12px;
    }

    .interlinear-legacy summary {
        cursor: pointer;
        font-size: 13px;
        color: #3f4b6b;
        outline: none;
    }

    @media only screen and (max-width: 767px) {
        .hebrew-interlinear-grid {
            justify-content: flex-start;
            gap: 8px;
        }

        .interlinear-card {
            min-width: 100px;
            max-width: 180px;
        }

        .interlinear-card .card-hebrew {
            font-size: 24px;
        }
    }

</style>

<div class="desktop-view">
    <table class="front_search" style="border: none;">
        <tbody>
            <tr>
                <td>
                    <form method="get" action="https://read.realbible.tech/" style="text-align: left;">
                        <input type="text" name="ref" placeholder="Enter a reference...">
                        <input type="hidden" name="book" id="book" value="{{ book }}">
                        <input type="hidden" name="chapter" id="chapter" value="{{ chapter_num }}">
                        <input type="hidden" name="verse" id="verse" value="{{ verse_num }}">
                        <button type="submit">Search</button>
                    </form>
                </td>
                <td class="front">
                    <form method="get" action="https://read.realbible.tech/" style="text-align: left;">
                        <input type="text" name="q" placeholder="Enter a search word...">
                        <select name="book">
                            <option value="all">Search all books</option>
                            <option value="OT">Search all Hebrew books</option>
                            <option value="NT">Search all Greek books</option>
                            <option value="Gen">In the Head</option>
                            <option value="Exo">And a Mighty One</option>
                            <option value="Lev">And He is Reading</option>
                            <option value="Num">And He is Ordering Words</option>
                            <option value="Deu">A Mighty One of the Words</option>
                            <option value="Jos">He is Salvation</option>
                            <option value="Jdg">Rulers</option>
                            <option value="Rut">Companion</option>
                            <option value="1Sa">His Name is God 1</option>
                            <option value="2Sa">His Name is God 2</option>
                            <option value="1Ki">Kings 1</option>
                            <option value="2Ki">Kings 2</option>
                            <option value="1Ch">Words of the Days 1</option>
                            <option value="2Ch">Words of the Days 2</option>
                            <option value="Ezr">Helper</option>
                            <option value="Neh">He is Comfort</option>
                            <option value="Est">I am Hidden</option>
                            <option value="Job">Adversary</option>
                            <option value="Psa">Melodies</option>
                            <option value="Pro">Comparisons</option>
                            <option value="Ecc">Words of the Teacher</option>
                            <option value="Son">Song of Singing Ones</option>
                            <option value="Isa">He Is Liberator</option>
                            <option value="Jer">He Is Lifting Up</option>
                            <option value="Lam">How She has Sat Separated!</option>
                            <option value="Eze">God Holds Strongly</option>
                            <option value="Dan">God Has Judged</option>
                            <option value="Hos">Salvation</option>
                            <option value="Joe">He is a Mighty One</option>
                            <option value="Amo">Heavy Burdened</option>
                            <option value="Oba">Slave of He Is</option>
                            <option value="Jon">Dove</option>
                            <option value="Mic">Who is Like Her?</option>
                            <option value="Nah">Sorry/Consolation</option>
                            <option value="Hab">Embrace Himself</option>
                            <option value="Zep">He is Concealed</option>
                            <option value="Hag">Festival</option>
                            <option value="Zec">He Is Remembered</option>
                            <option value="Mal">Angel of Myself</option>
                            <option value="Mat">He Is a Gift</option>
                            <option value="Mar">Hammer</option>
                            <option value="Luk">Light Giver</option>
                            <option value="Joh">He Is Favored</option>
                            <option value="Act">Acts of the Sent Away Ones</option>
                            <option value="Rom">The People of Bodily Strength</option>
                            <option value="1Co">The People of Youth 1</option>
                            <option value="2Co">The People of Youth 2</option>
                            <option value="Gal">The People of the Land of Milk</option>
                            <option value="Eph">The People of the Land of Bees</option>
                            <option value="Php">The People of the Horse</option>
                            <option value="Col">The People of the Colossal Ones</option>
                            <option value="1Th">The People of the Prayer of Victory 1</option>
                            <option value="2Th">The People of the Prayer of Victory 2</option>
                            <option value="1Ti">Honored One 1</option>
                            <option value="2Ti">Honored One 2</option>
                            <option value="Tit">Avenged</option>
                            <option value="Phm">Affectionate One</option>
                            <option value="Heb">Beyond Ones</option>
                            <option value="Jas">Heel Chaser</option>
                            <option value="1Pe">Small Stone 1</option>
                            <option value="2Pe">Small Stone 2</option>
                            <option value="1Jo">Favored 1</option>
                            <option value="2Jo">Favored 2</option>
                            <option value="3Jo">Favored 3</option>
                            <option value="Jud">Cast One</option>
                            <option value="Rev">The Unveiling</option>
                        </select>
                        <button type="submit">Search</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Mobile view -->
<div class="mobile-view">
    <table class="front_search" style="border: none;">
        <tbody>
            <tr>
                <td class="front">
                    <form method="get" action="https://read.realbible.tech/">
                        <input type="text" name="ref" placeholder="Enter a reference...">
                        <input type="hidden" name="book" id="book" value="{{ book }}">
                        <input type="hidden" name="chapter" id="chapter" value="{{ chapter_num }}">
                        <input type="hidden" name="verse" id="verse" value="{{ verse_num }}">
                        <button type="submit">Search</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="front_search" style="border: none;">
        <tbody>
            <tr>
                <td class="front">
                    <form method="get" action="https://read.realbible.tech/">
                        <input type="text" name="q" placeholder="Enter a search word...">
                        <select name="book">
                            <option value="all">Search all books</option>
                            <option value="OT">Search all Hebrew books</option>
                            <option value="NT">Search all Greek books</option>
                            <option value="Gen">In the Head</option>
                            <option value="Exo">And a Mighty One</option>
                            <option value="Lev">And He is Reading</option>
                            <option value="Num">And He is Ordering Words</option>
                            <option value="Deu">A Mighty One of the Words</option>
                            <option value="Jos">He is Salvation</option>
                            <option value="Jdg">Rulers</option>
                            <option value="Rut">Companion</option>
                            <option value="1Sa">His Name is God 1</option>
                            <option value="2Sa">His Name is God 2</option>
                            <option value="1Ki">Kings 1</option>
                            <option value="2Ki">Kings 2</option>
                            <option value="1Ch">Words of the Days 1</option>
                            <option value="2Ch">Words of the Days 2</option>
                            <option value="Ezr">Helper</option>
                            <option value="Neh">He is Comfort</option>
                            <option value="Est">I am Hidden</option>
                            <option value="Job">Adversary</option>
                            <option value="Psa">Melodies</option>
                            <option value="Pro">Comparisons</option>
                            <option value="Ecc">Words of the Teacher</option>
                            <option value="Son">Song of Singing Ones</option>
                            <option value="Isa">He Is Liberator</option>
                            <option value="Jer">He Is Lifting Up</option>
                            <option value="Lam">How She has Sat Separated!</option>
                            <option value="Eze">God Holds Strongly</option>
                            <option value="Dan">God Has Judged</option>
                            <option value="Hos">Salvation</option>
                            <option value="Joe">He is a Mighty One</option>
                            <option value="Amo">Heavy Burdened</option>
                            <option value="Oba">Slave of He Is</option>
                            <option value="Jon">Dove</option>
                            <option value="Mic">Who is Like Her?</option>
                            <option value="Nah">Sorry/Consolation</option>
                            <option value="Hab">Embrace Himself</option>
                            <option value="Zep">He is Concealed</option>
                            <option value="Hag">Festival</option>
                            <option value="Zec">He Is Remembered</option>
                            <option value="Mal">Angel of Myself</option>
                            <option value="Mat">He Is a Gift</option>
                            <option value="Mar">Hammer</option>
                            <option value="Luk">Light Giver</option>
                            <option value="Joh">He Is Favored</option>
                            <option value="Act">Acts of the Sent Away Ones</option>
                            <option value="Rom">The People of Bodily Strength</option>
                            <option value="1Co">The People of Youth 1</option>
                            <option value="2Co">The People of Youth 2</option>
                            <option value="Gal">The People of the Land of Milk</option>
                            <option value="Eph">The People of the Land of Bees</option>
                            <option value="Php">The People of the Horse</option>
                            <option value="Col">The People of the Colossal Ones</option>
                            <option value="1Th">The People of the Prayer of Victory 1</option>
                            <option value="2Th">The People of the Prayer of Victory 2</option>
                            <option value="1Ti">Honored One 1</option>
                            <option value="2Ti">Honored One 2</option>
                            <option value="Tit">Avenged</option>
                            <option value="Phm">Affectionate One</option>
                            <option value="Heb">Beyond Ones</option>
                            <option value="Jas">Heel Chaser</option>
                            <option value="1Pe">Small Stone 1</option>
                            <option value="2Pe">Small Stone 2</option>
                            <option value="1Jo">Favored 1</option>
                            <option value="2Jo">Favored 2</option>
                            <option value="3Jo">Favored 3</option>
                            <option value="Jud">Cast One</option>
                            <option value="Rev">The Unveiling</option>
                        </select>
                        <button type="submit">Search</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>

</div>

{% if error %}
<p style="margin-top: 20px;" class="callout-red"> ⚠️ <strong>Error</strong>:&nbsp;{{ error }}</p>

{% endif %}

<div class="arrow-links">
    <a href="?book={{book}}&chapter={{chapter_num}}">Chapter {{ chapter_num }}</a>
    <h3 class="verse-view">
        {% if previous_verse %}
        <a href="{{ previous_verse }}">{% endif %}<img src="http://www.realbible.tech/wp-content/uploads/2023/12/left_arrow.png" style="height: 30px; vertical-align: middle;"> </a>
        
        {{ book }} {{ chapter_num }}:{{ verse_num }}
        {% if next_verse %}<a href="{{ next_verse }}">{% endif %} <img src="http://www.realbible.tech/wp-content/uploads/2023/12/right_arrow-1-e1702991328715.png" style="height: 30px; vertical-align: middle;"></a>
    </h3>
    
</div>

{% if hebrew %}
<div style="display: flex; justify-content: flex-end;">
    <label for="niqqudSwitch" style="font-size: 12px;">Show Niqqud &nbsp</label>
    <input type="checkbox" id="niqqudSwitch" onclick="toggleNiqqud()">
</div>
<div>
    <div style="display: flex; justify-content: flex-end;">
        <div style="font-size: 34px;text-align: right; margin-bottom: 1em;" id="hebText"></div>
    </div>
</div>
{% endif %}

{% if hebrew_interlinear_cards %}
<strong>RBT Hebrew Interlinear:</strong>
<div class="hebrew-interlinear-grid">
    {% for cell in hebrew_interlinear_cards %}
    <div class="interlinear-card">
        <div class="card-hebrew">
            <span class="hebrew-no-niqqud">{{ cell.hebrew|safe }}</span>
            <span class="hebrew-with-niqqud">{{ cell.hebrew_niqqud|safe }}</span>
        </div>
        <div class="card-english">{{ cell.english|safe }}</div>
        {% if cell.strongs %}
        <div class="card-strongs">{{cell.strongs|safe}}</div>
        {% endif %}
        {% if cell.morph %}
        <div class="card-morph">{{ cell.morph|safe }}</div>
        {% endif %}
        {% if cell.lxx_words or cell.lxx or cell.lxx_data %}
        <div class="card-lxx">
            <span class="lxx-popup-container">
                <span style="color: #666; font-size: 11px;">LXX:</span>
                {% if cell.lxx_words %}
                    {% for word in cell.lxx_words %}
                        <a href="https://logeion.uchicago.edu/{{ word }}" target="_blank">{{ word }}</a>{% if not forloop.last %} {% endif %}
                    {% endfor %}
                {% elif cell.lxx %}
                    {% for word in cell.lxx.split %}
                        <a href="https://logeion.uchicago.edu/{{ word }}" target="_blank">{{ word }}</a>{% if not forloop.last %} {% endif %}
                    {% endfor %}
                {% endif %}
                {% if cell.lxx_data %}
                <div class="lxx-popup-content">
                    <div class="lxx-popup-header">LXX Usage Statistics <a href="https://en.wikipedia.org/wiki/Septuagint" target="_blank" title="Learn about the Septuagint"><i class="fas fa-up-right-from-square"></i></a></div>
                    {% for lxx_item in cell.lxx_data %}
                    <div class="lxx-stats-section">
                        <div class="strongs-label">{{ lxx_item.strongs }}:</div>
                        {% for stat in lxx_item.stats %}
                        <div class="lxx-stats-row">
                            <span class="stat-label"><a href="https://logeion.uchicago.edu/{{ stat.0 }}" target="_blank">{{ stat.0 }}</a></span>
                            <span class="stat-bar-container"><span class="stat-bar" style="width: {{ stat.2 }}%;"></span></span>
                            <span class="stat-info">{{ stat.1 }}× ({{ stat.2 }}%)</span>
                        </div>
                        {% empty %}
                        <div class="lxx-stats-row">No stats available</div>
                        {% endfor %}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </span>
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% endif %}



{% if greek %}
<div style="font-size: 34px; margin-bottom: 1em;">
{{ greek|safe }}
</div>
{% endif %}

{% if greek_interlinear %}
<div class="greek_interlinear">
    <strong>RBT Greek Interlinear:</strong><br>
    {{ greek_interlinear|safe }}
</div>
<div class="clearfix">
</div>
{% endif %}


<script>
    var rbt_heb = `{{ hebrew | safe }}`;

    // Function to remove niqqud characters from the Hebrew text
    function removeNiqqud(text) {
        // Regular expression pattern to match niqqud characters
        var niqqudPattern = /[\u0591-\u05BD\u05BF\u05C1-\u05C5\u05C7]/g;
        return text.replace(niqqudPattern, '');
    }

    // Function to toggle the niqqud visibility based on the checkbox state
    function toggleCardNiqqud(showNiqqud) {
        var cardContainers = document.querySelectorAll('.card-hebrew');
        cardContainers.forEach(function(card) {
            var withNiqqud = card.querySelector('.hebrew-with-niqqud');
            var noNiqqud = card.querySelector('.hebrew-no-niqqud');

            if (!withNiqqud || !noNiqqud) {
                return;
            }

            withNiqqud.style.display = showNiqqud ? 'block' : 'none';
            noNiqqud.style.display = showNiqqud ? 'none' : 'block';
        });
    }

    function toggleNiqqud() {
        var hebText = document.getElementById("hebText");
        var niqqudSwitch = document.getElementById("niqqudSwitch");

        if (niqqudSwitch.checked) {
            hebText.innerHTML = rbt_heb;
            toggleCardNiqqud(true);
        } else {
            hebText.innerHTML = removeNiqqud(rbt_heb);
            toggleCardNiqqud(false);
        }
    }

    // Initially, set the innerHTML to the original rbt_heb content with niqqud removed
    document.getElementById("hebText").innerHTML = removeNiqqud(rbt_heb);
    toggleCardNiqqud(false);
</script>

    {% if rbt %}
        <div class="single_verse">
            <span id="englishReader">{{ rbt|safe }}
            </span>
        </div>
        <div id="inputText" style="display: none; width: 100%;" oninput="updateEnglishReader(this.value)">{{ rbt_text }}</div>
        
        {% if rbt_paraphrase %}
        <div class="single_verse">
            <strong>RBT Paraphrase:</strong>

            <br>
        {{ rbt_paraphrase|safe }}

        </div>
        {% endif %}
        
        {{ slt|safe }}
        {{ litv|safe }}
        {{ englxx|safe }}

        <h4>Footnotes</h4>
        <div>
            <table>
            {{ footnotes|safe }}
            </table>
        </div>
        
    {% else %}

        <p>No verses found for chapter {{ chapter_num }}.</p>
    {% endif %}
<script>
    function updateEnglishReader(text) {
        var englishReader = document.getElementById('englishReader');
        englishReader.innerHTML = text;
    }

</script>

<!-- <script>
    {% if cache_hit %}
        console.log("Verse(s) served from cache.");
    {% else %}
        console.log("Verse(s) not served from cache.");
    {% endif %}
</script> -->

{% endblock %}
